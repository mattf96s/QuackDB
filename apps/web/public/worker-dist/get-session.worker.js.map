{
  "version": 3,
  "sources": ["../../types/tree.ts", "../../workers/get-session.worker.ts"],
  "sourcesContent": ["export type File = {\n\ttype: \"file\";\n\tname: string;\n};\n\nexport type Folder = {\n\ttype: \"folder\";\n\tname: string;\n\tcontents: TreeItem[];\n};\n\nexport type TreeItem = File | Folder;\n\nexport type Tree = TreeItem[];\n\nexport async function buildStructuredTreeFromHandle(\n\tdirHandle: FileSystemDirectoryHandle,\n): Promise<Tree> {\n\tconst tree: Tree = [];\n\n\tfor await (const [name, handle] of dirHandle.entries()) {\n\t\tif (handle.kind === \"file\") {\n\t\t\ttree.push({\n\t\t\t\ttype: \"file\",\n\t\t\t\tname,\n\t\t\t});\n\t\t} else if (handle.kind === \"directory\") {\n\t\t\tconst subTree = await buildStructuredTreeFromHandle(handle);\n\t\t\ttree.push({\n\t\t\t\ttype: \"folder\",\n\t\t\t\tname,\n\t\t\t\tcontents: subTree,\n\t\t\t});\n\t\t}\n\t}\n\n\treturn tree;\n}\n", "/// <reference lib=\"webworker\" />\n\nimport { buildStructuredTreeFromHandle } from \"@/types/tree\";\n\n// https://github.com/vercel/turborepo/issues/3643#issuecomment-2689349937\nself.onmessage = async (event: MessageEvent) => {\n\tself.postMessage({\n\t\ttype: \"SET_LOADING\",\n\t\tloading: true,\n\t});\n\n\tconst { id } = event.data;\n\n\ttry {\n\t\tconst root = await navigator.storage.getDirectory();\n\t\tconst directory = await root.getDirectoryHandle(id, { create: true });\n\n\t\t// list all files in the directory\n\t\tconst tree = await buildStructuredTreeFromHandle(directory);\n\n\t\tself.postMessage({\n\t\t\ttype: \"SET_CONTENTS\",\n\t\t\ttree,\n\t\t});\n\t} catch (error) {\n\t\tconsole.error(\"Error in worker: \", error);\n\t\tself.postMessage({\n\t\t\ttype: \"SET_ERROR\",\n\t\t\terror: error instanceof Error ? error.message : String(error),\n\t\t});\n\t\treturn;\n\t}\n};\n"],
  "mappings": ";AAeA,eAAsB,8BACrB,WACgB;AAChB,QAAM,OAAa,CAAC;AAEpB,mBAAiB,CAAC,MAAM,MAAM,KAAK,UAAU,QAAQ,GAAG;AACvD,QAAI,OAAO,SAAS,QAAQ;AAC3B,WAAK,KAAK;AAAA,QACT,MAAM;AAAA,QACN;AAAA,MACD,CAAC;AAAA,IACF,WAAW,OAAO,SAAS,aAAa;AACvC,YAAM,UAAU,MAAM,8BAA8B,MAAM;AAC1D,WAAK,KAAK;AAAA,QACT,MAAM;AAAA,QACN;AAAA,QACA,UAAU;AAAA,MACX,CAAC;AAAA,IACF;AAAA,EACD;AAEA,SAAO;AACR;;;AChCA,KAAK,YAAY,OAAO,UAAwB;AAC/C,OAAK,YAAY;AAAA,IAChB,MAAM;AAAA,IACN,SAAS;AAAA,EACV,CAAC;AAED,QAAM,EAAE,GAAG,IAAI,MAAM;AAErB,MAAI;AACH,UAAM,OAAO,MAAM,UAAU,QAAQ,aAAa;AAClD,UAAM,YAAY,MAAM,KAAK,mBAAmB,IAAI,EAAE,QAAQ,KAAK,CAAC;AAGpE,UAAM,OAAO,MAAM,8BAA8B,SAAS;AAE1D,SAAK,YAAY;AAAA,MAChB,MAAM;AAAA,MACN;AAAA,IACD,CAAC;AAAA,EACF,SAAS,OAAO;AACf,YAAQ,MAAM,qBAAqB,KAAK;AACxC,SAAK,YAAY;AAAA,MAChB,MAAM;AAAA,MACN,OAAO,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK;AAAA,IAC7D,CAAC;AACD;AAAA,EACD;AACD;",
  "names": []
}
